<!doctype html>
<html>
	<head>
		<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	</head>
	<body>
		<div id="bodycon">
			
		</div>
		
		<script src="https://www.gstatic.com/firebasejs/4.9.0/firebase.js"></script>
		<script src="https://www.gstatic.com/firebasejs/4.9.1/firebase-firestore.js"></script>
		<script>
			// Initialize Firebase
			var config = {
				apiKey: "AIzaSyCKxEYUtxMrevfSLSRHKUHc7gKTSKBZ-Vg",
				authDomain: "somsritshirt-ced49.firebaseapp.com",
				databaseURL: "https://somsritshirt-ced49.firebaseio.com",
				projectId: "somsritshirt-ced49",
				storageBucket: "somsritshirt-ced49.appspot.com",
				messagingSenderId: "99816736698"
			};
			firebase.initializeApp(config);
			
			var db = firebase.firestore();
		</script>
		<script>
			function getParameterByName(name, url) {
				if (!url) url = window.location.href;
				name = name.replace(/[\[\]]/g, "\\$&");
				var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
					results = regex.exec(url);
				if (!results) return null;
				if (!results[2]) return '';
				return decodeURIComponent(results[2].replace(/\+/g, " "));
			}
			
			var blogid = getParameterByName('id');
			var blogdata = {};
			var blogbody = [];
			db.collection("blog").doc(blogid).get().then(function(data) {
				if (data.exists) {
					blogdata = data.data();
					blogbody = blogdata.body;
					main();
				} else console.log("Blog doesn't exists");
			}).catch(function(e) {
				console.log("Error",e);
			});
			
			function main() {
				blogbody.forEach(function(data) {
					if (data.type==0) {
						$("<p></p>").text(data.text).appendTo($("#bodycon"));
					} else if (data.type==1) {
						$("<img></img>").attr("src",data.src).appendTo($("#bodycon"));
					}
				});
			}
			
		</script>
	</body>
</html>